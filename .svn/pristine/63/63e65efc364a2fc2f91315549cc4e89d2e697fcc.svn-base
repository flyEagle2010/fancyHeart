package com.doteyplay.game.message.chat;                                                                                                                                                                                       
                                                                                                                                                                                                                             
import org.apache.log4j.Logger;
import org.apache.mina.core.buffer.IoBuffer;

import com.doteyplay.game.MessageCommands;
import com.doteyplay.game.message.proto.ChatProBuf;
import com.doteyplay.net.message.AbstractMessage;
import com.google.protobuf.InvalidProtocolBufferException;
                                                                                                                                                                                                                             
public class ChatMessage extends AbstractMessage                                                                                                                                                                               
{                                                                                                                                                                                                                            
	/**
	 * @author:Tom.Zheng
	 * @createTime:2014年12月1日 下午6:24:41
	 */
	private static final long serialVersionUID = 4854268970298266071L;

	private static final Logger logger = Logger                                                                                                                                                                              
			.getLogger(ChatMessage.class);                                                                                                                                                                                     
                                                                                                                                                                                                                             
	private String source;   
	
	private int type;
	
	private String result;
	public ChatMessage()                                                                                                                                                                                                       
	{                                                                                                                                                                                                                        
		super(MessageCommands.CHAT_MESSAGE);                                                                                                                                                                                   
	}                                                                                                                                                                                                                        
                                                                                                                                                                                                                             
	@Override                                                                                                                                                                                                                
	public void decodeBody(IoBuffer in)                                                                                                                                                                                      
	{                                                                                                                                                                                                                        
		byte[] bytes = getProtoBufBytes(in);                                                                                                                                                                                 
		try                                                                                                                                                                                                                  
		{                                                                                                                                                                                                                    
			ChatProBuf.PChatReq req = ChatProBuf.PChatReq                                                                                                                                                            
					.parseFrom(bytes);                                                                                                                                                                                       
			source = req.getMsg(); 
			type = req.getType();
		} catch (InvalidProtocolBufferException e)                                                                                                                                                                           
		{                                                                                                                                                                                                                    
			e.printStackTrace();                                                                                                                                                                                             
		}                                                                                                                                                                                                                    
	}                                                                                                                                                                                                                        
                                                                                                                                                                                                                             
	@Override                                                                                                                                                                                                                
	public void encodeBody(IoBuffer out)                                                                                                                                                                                     
	{                                                                                                                                                                                                                        
		ChatProBuf.PChatResp.Builder builder = ChatProBuf.PChatResp                                                                                                                                                    
				.newBuilder();  
		builder.setMsg(result);
		out.put(builder.build().toByteArray());
	}                                                                                                                                                                                                                        
                                                                                                                                                                                                                             
	@Override                                                                                                                                                                                                                
	public void release() {                                                                                                                                                                                                  
		// TODO Auto-generated method stub                                                                                                                                                                                   
		                                                                                                                                                                                                                     
	}

	public String getSource() {
		return source;
	}

	public void setSource(String source) {
		this.source = source;
	}

	public String getResult() {
		return result;
	}

	public void setResult(String result) {
		this.result = result;
	}

	public int getType() {
		return type;
	}

	public void setType(int type) {
		this.type = type;
	}  
	
	
	
}                                                                                                                                                                                                                            
                                                                                                                                                                                                                             
